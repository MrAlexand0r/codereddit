$(function(){var a=grabHash(window.location.hash);posts=renderPost(a);$("body").delegate(".expander","click",function(){$(this).parents("ul").first().find(".comments").is(":empty")?getComments($(this).attr("id"),$(this).parents("ul").first().find(".comments")):$(this).parents("ul").first().find(".comments").show();$(this).attr("src","img/collapse.png");$(this).addClass("collapse");$(this).removeClass("expander")});$("body").delegate(".collapse","click",function(){$(this).parents("ul").first().find(".comments").hide();
$(this).attr("src","img/expand.png");$(this).addClass("expander");$(this).removeClass("collapse")});$(window).bind("hashchange",function(a){a=a.fragment;$("body").html("");renderPost(a)})});
function renderPost(a){a=""!=a?"http://www.reddit.com/r/"+a+"/.json?jsonp=?":"http://www.reddit.com/.json?jsonp=?";return $.getJSON(a,function(d){var c;a=window.location.hash;c="<pre class='php'>\nrequire('<a href='readme.html'>readme.php</a>');\nsession_start();</pre>";c=a?c+("<pre class='php'>$subreddit = $_GET[\""+a+'"];</pre>'):c+"<pre class='php'>$subreddit = $_GET[\"frontpage\"];</pre>";$("body").append(c);$.each(d.data.children,function(a){var b=d.data.children[a].data,c=createTitle(b,a);$.get("php.html",
function(a){a=a.replace("${title}",c);a=b.selftext?a.replace("${selftext}",formatSelfText(b.selftext)):a.replace("${selftext}","");"imgur.com"==b.domain&&(b.url=b.url.replace("imgur.com","i.imgur.com")+".jpg");a=/\.(jpg)|(gif)|(png)$/.test(b.url)?a.replace("${fancybox}","image"):/www.youtube.com/.test(b.url)?a.replace("${fancybox}","video"):a.replace("${fancybox}","");a=a.replace("${subreddit}",b.subreddit);a=a.replace("${suburl}","#"+b.subreddit);a=a.replace("${url}",b.url);a=a.replace("${author}",
b.author);a=a.replace("${score}",b.score);a=a.replace("${domain}",b.domain);a=a.replace("${fulltitle}",b.title);a=a.replace("${num_comments}",b.num_comments);a=a.replace("${entry_id}",b.name);$("body").append(a);$("pre.php").snippet("php",{style:"emacs",showNum:!1,transparent:!0,menu:!1});$("a.image").fancybox({transitionIn:"elastic",transitionOut:"elastic",speedIn:600,speedOut:200})})})})}
function createTitle(a){a=a.title.toLowerCase().substring(0,20).replace(/[^A-Za-z0-9\s\s+]/gi,"").split(" ");for(token in a)a[token]=a[token].charAt(0).toUpperCase()+a[token].slice(1);return a=a.join("")}function grabHash(a){return a.replace("#","")}function getComments(a,d){var c=a.replace("t3_","");text="";$.getJSON("http://www.reddit.com/comments/"+c+".json?jsonp=?",function(a){a=a[1].data.children.slice(0,20);$.each(a,function(b){text+=a[b].data.body;d.text(text)});return text});return text}
function formatSelfText(a){var a=a.replace(/(\r\n|\n|\r)/gm,""),d="";num_splits=Math.floor(a.length/80);for(i=0;i<=num_splits;)d=d+"// "+a.substring(80*i,80*(i+1))+"\n    ",i++;return d};